<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mrahulrahi | Brand Identity & Admin</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: {
                            black: '#09090B', // Void Black
                            surface: '#18181B', // Graphite
                            surfaceHighlight: '#27272A',
                            white: '#F8FAFC', // Vapor White
                            mint: '#00DC82', // Electric Mint
                            fern: '#047857', // Deep Fern
                            glow: '#BBF7D0', // Lime Glow
                            text: '#ECEDEE', // Text Main
                            muted: '#A1A1AA', // Text Muted
                            border: '#27272A', // Border Color
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    backgroundImage: {
                        'grid-pattern': "linear-gradient(to right, var(--grid-color) 1px, transparent 1px), linear-gradient(to bottom, var(--grid-color) 1px, transparent 1px)",
                    }
                }
            }
        }
    </script>

    <style>
        :root {
            --grid-color: #E5E7EB;
        }
        .dark {
            --grid-color: #27272A;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #D1D5DB;
            border-radius: 4px;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #27272A;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #00DC82;
        }

        .bg-grid {
            background-size: 40px 40px;
            mask-image: linear-gradient(to bottom, black 40%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, black 40%, transparent 100%);
        }

        .cursor-blink {
            animation: blink 1s step-end infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(229, 231, 235, 0.5);
        }
        .dark .glass {
            background: rgba(24, 24, 27, 0.7);
            border: 1px solid rgba(39, 39, 42, 0.5);
        }
        
        /* App Sidebar Styles */
        .nav-item.active {
            background-color: rgba(0, 220, 130, 0.1);
            color: #00DC82;
            border-right: 2px solid #00DC82;
        }
        .nav-item:hover:not(.active) {
            background-color: rgba(39, 39, 42, 0.5);
        }

        /* Fixed Range Input Styling */
        input[type=range] {
            -webkit-appearance: none;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #00DC82;
            margin-top: -4px;
            cursor: pointer;
            box-shadow: 0 0 0 2px rgba(24, 24, 27, 0.5);
            transition: transform 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            border-radius: 999px;
        }
        input[type=range]:focus {
            outline: none; 
        }
        
        /* Toggle Switch CSS */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #00DC82;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #00DC82;
        }
        .toggle-checkbox {
            right: 0;
            transition: all 0.3s;
            border-color: #e5e7eb;
        }
        .dark .toggle-checkbox {
            border-color: #4b5563;
        }
        .toggle-label {
            width: 40px;
        }
        .toggle-checkbox:checked {
            transform: translateX(0);
        }
        .toggle-checkbox:not(:checked) {
             right: auto;
             left: 0;
        }
    </style>
</head>

 <script>
        // 1. Initialize Icons
        lucide.createIcons();

        // 2. View Switching Logic
        const viewStyleGuide = document.getElementById('view-styleguide');
        const viewApp = document.getElementById('view-app');
        const btnStyleGuide = document.getElementById('btn-styleguide');
        const btnApp = document.getElementById('btn-app');

        function switchView(viewName) {
            if (viewName === 'styleguide') {
                viewStyleGuide.classList.remove('hidden');
                viewApp.classList.add('hidden');
                btnStyleGuide.classList.add('bg-white', 'dark:bg-brand-surfaceHighlight', 'shadow-sm', 'text-gray-900', 'dark:text-white');
                btnStyleGuide.classList.remove('text-gray-500', 'dark:text-brand-muted');
                btnApp.classList.remove('bg-white', 'dark:bg-brand-surfaceHighlight', 'shadow-sm', 'text-gray-900', 'dark:text-white');
                btnApp.classList.add('text-gray-500', 'dark:text-brand-muted');
            } else {
                viewStyleGuide.classList.add('hidden');
                viewApp.classList.remove('hidden');
                btnApp.classList.add('bg-white', 'dark:bg-brand-surfaceHighlight', 'shadow-sm', 'text-gray-900', 'dark:text-white');
                btnApp.classList.remove('text-gray-500', 'dark:text-brand-muted');
                btnStyleGuide.classList.remove('bg-white', 'dark:bg-brand-surfaceHighlight', 'shadow-sm', 'text-gray-900', 'dark:text-white');
                btnStyleGuide.classList.add('text-gray-500', 'dark:text-brand-muted');
                initDashboardChart();
            }
        }

        // 3. App Internal Navigation
        const pageDashboard = document.getElementById('page-dashboard');
        const pagePortfolio = document.getElementById('page-portfolio');
        const pageEmi = document.getElementById('page-emi');
        const pageSettings = document.getElementById('page-settings');
        
        const navDashboard = document.getElementById('nav-dashboard');
        const navPortfolio = document.getElementById('nav-portfolio');
        const navEmi = document.getElementById('nav-emi');
        const navSettings = document.getElementById('nav-settings');
        
        const breadcrumbCurrent = document.getElementById('breadcrumb-current');

        function switchAppPage(pageName) {
            // Reset Active classes
            [navDashboard, navPortfolio, navEmi, navSettings].forEach(nav => {
                if(nav) {
                    nav.classList.remove('active', 'text-brand-mint');
                    nav.classList.add('text-gray-600', 'dark:text-brand-muted');
                }
            });

            // Hide all pages
            pageDashboard.classList.add('hidden');
            pagePortfolio.classList.add('hidden');
            pageEmi.classList.add('hidden');
            pageSettings.classList.add('hidden');

            if (pageName === 'dashboard') {
                pageDashboard.classList.remove('hidden');
                navDashboard.classList.add('active');
                navDashboard.classList.remove('text-gray-600', 'dark:text-brand-muted');
                breadcrumbCurrent.innerText = "Dashboard";
            } else if (pageName === 'portfolio') {
                pagePortfolio.classList.remove('hidden');
                navPortfolio.classList.add('active');
                navPortfolio.classList.remove('text-gray-600', 'dark:text-brand-muted');
                breadcrumbCurrent.innerText = "Portfolio Manager";
            } else if (pageName === 'emi') {
                pageEmi.classList.remove('hidden');
                navEmi.classList.add('active');
                navEmi.classList.remove('text-gray-600', 'dark:text-brand-muted');
                breadcrumbCurrent.innerText = "Smart EMI Tool";
                updateEMIView();
            } else if (pageName === 'settings') {
                pageSettings.classList.remove('hidden');
                navSettings.classList.add('active');
                navSettings.classList.remove('text-gray-600', 'dark:text-brand-muted');
                breadcrumbCurrent.innerText = "Configuration";
            }
        }

        // 4. Chart Logic (Dashboard)
        let dashboardChartInstance = null;
        function initDashboardChart() {
            if (dashboardChartInstance) return; 
            const ctx = document.getElementById('mainDashboardChart').getContext('2d');
            const isDark = document.documentElement.classList.contains('dark');
            const gridColor = isDark ? '#27272A' : '#E5E7EB';
            const textColor = isDark ? '#A1A1AA' : '#6B7280';

            dashboardChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Visitors',
                        data: [120, 190, 300, 500, 220, 300, 450],
                        borderColor: '#00DC82',
                        backgroundColor: (context) => {
                            const ctx = context.chart.ctx;
                            const gradient = ctx.createLinearGradient(0, 0, 0, 300);
                            gradient.addColorStop(0, 'rgba(0, 220, 130, 0.2)');
                            gradient.addColorStop(1, 'rgba(0, 220, 130, 0)');
                            return gradient;
                        },
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#09090B',
                        pointBorderColor: '#00DC82',
                        pointRadius: 4,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false }, ticks: { color: textColor, font: { family: 'JetBrains Mono' } } },
                        y: { grid: { color: gridColor, borderDash: [4, 4] }, ticks: { color: textColor, font: { family: 'JetBrains Mono' } } }
                    }
                }
            });
        }

        // 5. SMART EMI LOGIC
        let emiState = { loanAmount: 5000000, rate: 8.5, tenure: 20, increase: 10, extraEmi: true };
        let emiChartInstance = null;
        const inpLoan = document.getElementById('inp-loan');
        const inpRate = document.getElementById('inp-rate');
        const inpTenure = document.getElementById('inp-tenure');
        const inpIncrease = document.getElementById('inp-increase');
        const dispIncrease = document.getElementById('disp-increase');
        const btnToggleExtra = document.getElementById('btn-toggle-extra');
        const toggleCircle = document.getElementById('toggle-circle');

        const formatCurrency = (val) => new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 }).format(val);
        const calculateEMI = (p, r, n) => {
            const monthlyRate = r / 12 / 100;
            return (p * monthlyRate * Math.pow(1 + monthlyRate, n)) / (Math.pow(1 + monthlyRate, n) - 1);
        };

        const runAmortization = (principal, annualRate, tenureYears, yearlyIncrease, extraEmiPerYear) => {
             let balance = principal;
             const monthlyRate = annualRate / 12 / 100;
             let currentEmi = calculateEMI(principal, annualRate, tenureYears * 12);
             const initialEmi = currentEmi;
             let totalInterest = 0;
             let totalPaid = 0;
             let month = 0;
             const yearlyData = [];

             while (balance > 1 && month < 600) {
                 month++;
                 const interestForMonth = balance * monthlyRate;
                 let principalForMonth = currentEmi - interestForMonth;
                 if (principalForMonth > balance) principalForMonth = balance;
                 balance -= principalForMonth;
                 totalInterest += interestForMonth;
                 totalPaid += (principalForMonth + interestForMonth);
                 if (extraEmiPerYear && month % 12 === 0 && balance > 0) {
                     let extraAmt = currentEmi;
                     if (extraAmt > balance) extraAmt = balance;
                     balance -= extraAmt;
                     totalPaid += extraAmt;
                 }
                 if (month % 12 === 0 || balance <= 1) {
                     const yearNum = Math.ceil(month / 12);
                     yearlyData.push({ year: yearNum, balance: Math.max(0, balance) });
                     if (month % 12 === 0) currentEmi = currentEmi * (1 + yearlyIncrease / 100);
                 }
                 if (balance <= 1) break;
             }
             return { totalMonths: month, totalInterest, totalPaid, yearlyData, initialEmi };
        };

        function updateEMIView() {
            const normal = runAmortization(emiState.loanAmount, emiState.rate, emiState.tenure, 0, false);
            const smart = runAmortization(emiState.loanAmount, emiState.rate, emiState.tenure, emiState.increase, emiState.extraEmi);
            document.getElementById('disp-standard-emi').innerText = formatCurrency(normal.initialEmi);
            document.getElementById('disp-smart-emi').innerText = formatCurrency(smart.initialEmi);
            const savedInt = normal.totalInterest - smart.totalInterest;
            const timeSavedM = normal.totalMonths - smart.totalMonths;
            const totalSaved = normal.totalPaid - smart.totalPaid;
            document.getElementById('val-interest-saved').innerText = formatCurrency(savedInt);
            document.getElementById('val-time-saved').innerText = `${Math.floor(timeSavedM/12)}y ${timeSavedM%12}m`;
            document.getElementById('val-total-saved').innerText = formatCurrency(totalSaved);
            updateEMIChart(normal.yearlyData, smart.yearlyData);
        }

        function updateEMIChart(normalData, smartData) {
            const ctx = document.getElementById('emiChart').getContext('2d');
            const maxYear = Math.max(normalData.length, smartData.length);
            const labels = Array.from({length: maxYear + 1}, (_, i) => `Yr ${i}`);
            const normPoints = labels.map((_, i) => { if(i===0) return emiState.loanAmount; const d = normalData.find(x => x.year === i); return d ? d.balance : (i > normalData[normalData.length-1]?.year ? 0 : null); });
            const smartPoints = labels.map((_, i) => { if(i===0) return emiState.loanAmount; const d = smartData.find(x => x.year === i); return d ? d.balance : (i > smartData[smartData.length-1]?.year ? 0 : null); });
            const isDark = document.documentElement.classList.contains('dark');
            const gridColor = isDark ? '#27272A' : '#E5E7EB';
            const textColor = isDark ? '#A1A1AA' : '#6B7280';

            if (emiChartInstance) {
                emiChartInstance.data.labels = labels;
                emiChartInstance.data.datasets[0].data = normPoints;
                emiChartInstance.data.datasets[1].data = smartPoints;
                emiChartInstance.options.scales.x.ticks.color = textColor;
                emiChartInstance.options.scales.y.ticks.color = textColor;
                emiChartInstance.options.scales.y.grid.color = gridColor;
                emiChartInstance.update();
            } else {
                emiChartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            { label: 'Standard Loan', data: normPoints, borderColor: '#9CA3AF', backgroundColor: 'rgba(156, 163, 175, 0.1)', borderWidth: 2, fill: true, tension: 0.4, pointRadius: 0 },
                            { label: 'Smart Plan', data: smartPoints, borderColor: '#00DC82', backgroundColor: 'rgba(0, 220, 130, 0.2)', borderWidth: 2, fill: true, tension: 0.4, pointRadius: 0 }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: { mode: 'index', intersect: false },
                        plugins: { legend: { display: true, labels: { color: textColor, font: {family: 'Inter'} } } },
                        scales: {
                            x: { grid: { display: false }, ticks: { color: textColor, font: { family: 'JetBrains Mono' } } },
                            y: { grid: { color: gridColor, borderDash: [4, 4] }, ticks: { color: textColor, font: { family: 'JetBrains Mono' }, callback: (val) => 'â‚¹' + val/100000 + 'L' } }
                        }
                    }
                });
            }
        }

        if(inpLoan) inpLoan.addEventListener('input', (e) => { emiState.loanAmount = Number(e.target.value); updateEMIView(); });
        if(inpRate) inpRate.addEventListener('input', (e) => { emiState.rate = Number(e.target.value); updateEMIView(); });
        if(inpTenure) inpTenure.addEventListener('input', (e) => { emiState.tenure = Number(e.target.value); updateEMIView(); });
        if(inpIncrease) inpIncrease.addEventListener('input', (e) => { emiState.increase = Number(e.target.value); dispIncrease.innerText = e.target.value + '%'; updateEMIView(); });
        if(btnToggleExtra) btnToggleExtra.addEventListener('click', () => {
            emiState.extraEmi = !emiState.extraEmi;
            if(emiState.extraEmi) {
                btnToggleExtra.classList.remove('bg-gray-300', 'dark:bg-gray-600');
                btnToggleExtra.classList.add('bg-brand-mint');
                toggleCircle.classList.remove('left-1');
                toggleCircle.classList.add('left-7');
            } else {
                btnToggleExtra.classList.add('bg-gray-300', 'dark:bg-gray-600');
                btnToggleExtra.classList.remove('bg-brand-mint');
                toggleCircle.classList.add('left-1');
                toggleCircle.classList.remove('left-7');
            }
            updateEMIView();
        });

        // 6. Theme Toggle Logic
        const themeToggleBtn = document.getElementById('theme-toggle');
        const htmlElement = document.documentElement;
        if (localStorage.getItem('color-theme') === 'light') {
            htmlElement.classList.remove('dark');
        } else {
            htmlElement.classList.add('dark');
        }
        themeToggleBtn.addEventListener('click', function() {
            htmlElement.classList.toggle('dark');
            const isDark = htmlElement.classList.contains('dark');
            localStorage.setItem('color-theme', isDark ? 'dark' : 'light');
            const gridColor = isDark ? '#27272A' : '#E5E7EB';
            const textColor = isDark ? '#A1A1AA' : '#6B7280';
            const updateChartTheme = (chart) => {
                if(!chart) return;
                chart.options.scales.y.grid.color = gridColor;
                chart.options.scales.x.ticks.color = textColor;
                chart.options.scales.y.ticks.color = textColor;
                chart.update();
            };
            updateChartTheme(dashboardChartInstance);
            updateChartTheme(emiChartInstance);
        });

        function showToast(message) {
            const toast = document.getElementById('toast');
            const msg = document.getElementById('toast-msg');
            msg.innerText = message;
            toast.classList.remove('translate-y-24');
            setTimeout(() => { toast.classList.add('translate-y-24'); }, 3000);
        }
        function copyLink() {
             navigator.clipboard.writeText(window.location.href).then(() => { showToast("Link copied to clipboard"); });
        }
        document.querySelectorAll('.palette-card').forEach(card => {
            card.addEventListener('click', function() {
                const color = this.getAttribute('data-color');
                const name = this.getAttribute('data-name');
                navigator.clipboard.writeText(color).then(() => { showToast(`${name} (${color}) copied`); });
            });
        });
    </script>
</html>